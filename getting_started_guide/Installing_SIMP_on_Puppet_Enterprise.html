

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>3.5. Installing SIMP on Puppet Enterprise &mdash; SIMP 5.2.1-0 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  
    <link rel="stylesheet" href="https://media.readthedocs.org/css/sphinx_rtd_theme.css" type="text/css" />
  
    <link rel="stylesheet" href="https://media.readthedocs.org/css/readthedocs-doc-embed.css" type="text/css" />
  
    <link rel="stylesheet" href="../_static/css_overrides.css" type="text/css" />
  

  
    <link rel="top" title="SIMP 5.2.1-0 documentation" href="../index.html"/>
        <link rel="up" title="3. SIMP Getting Started Guide" href="index.html"/>
        <link rel="next" title="3.6. Building a SIMP ISO" href="Building_A_SIMP_ISO.html"/>
        <link rel="prev" title="3.4. Installing SIMP using r10k or Code Manager" href="Installing_SIMP_using_r10k.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-nav-search">
        

        
          <a href="../index.html">
        

        
          
          <img src="../_static/SIMP_Logo.png" class="logo" />
        
        </a>

        
          
          
            <div class="version">
              5.2.1
            </div>
          
        

        
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

        
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        
          
          
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../index.html">Welcome to the SIMP documentation!</a></li>
</ul>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="Just_Install.html">1. For the Impatient</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dynamic/Changelog.html">2. Changelog</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">3. Getting Started</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="Introduction.html">3.1. Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../dynamic/Known_OS_Compatibility.html">3.2. Known OS Compatibility</a></li>
<li class="toctree-l2"><a class="reference internal" href="Installing_SIMP_From_A_Repository.html">3.3. Installing SIMP From A Repository</a></li>
<li class="toctree-l2"><a class="reference internal" href="Installing_SIMP_using_r10k.html">3.4. Installing SIMP using r10k or Code Manager</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">3.5. Installing SIMP on Puppet Enterprise</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#overview">3.5.1. Overview</a></li>
<li class="toctree-l3"><a class="reference internal" href="#system-requirements">3.5.2. System Requirements</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#puppet-enterprise">3.5.2.1. Puppet Enterprise</a></li>
<li class="toctree-l4"><a class="reference internal" href="#enable-epel">3.5.2.2. Enable EPEL</a></li>
<li class="toctree-l4"><a class="reference internal" href="#install-the-simp-project-dependencies-repository">3.5.2.3. Install The SIMP-project_dependencies Repository</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#disclaimer">3.5.3. Disclaimer</a></li>
<li class="toctree-l3"><a class="reference internal" href="#pre-install-tasks">3.5.4. Pre-install tasks</a></li>
<li class="toctree-l3"><a class="reference internal" href="#setting-up-your-control-repo">3.5.5. Setting up your Control Repo</a></li>
<li class="toctree-l3"><a class="reference internal" href="#configuring-hiera">3.5.6. Configuring Hiera</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="Building_A_SIMP_ISO.html">3.6. Building a SIMP ISO</a></li>
<li class="toctree-l2"><a class="reference internal" href="ISO_Install/index.html">3.7. SIMP Server ISO Installation Guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="Initial_Configuration.html">3.8. Initial Configuration</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../user_guide/index.html">4. User Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contributors_guide/index.html">5. Contributing to SIMP</a></li>
<li class="toctree-l1"><a class="reference internal" href="../security_conop/index.html">6. Security Concept of Operations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../security_mapping/index.html">7. Security Control Mapping</a></li>
<li class="toctree-l1"><a class="reference internal" href="../help/index.html">8. Help</a></li>
<li class="toctree-l1"><a class="reference internal" href="../license.html">9. License</a></li>
<li class="toctree-l1"><a class="reference internal" href="../license.html#contact">10. Contact</a></li>
<li class="toctree-l1"><a class="reference internal" href="../glossary.html">11. Glossary of Terms</a></li>
</ul>

          
        
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../index.html">SIMP</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html">Docs</a> &raquo;</li>
      
          <li><a href="index.html">3. SIMP Getting Started Guide</a> &raquo;</li>
      
    <li>3.5. Installing SIMP on Puppet Enterprise</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/getting_started_guide/Installing_SIMP_on_Puppet_Enterprise.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="installing-simp-on-puppet-enterprise">
<span id="install-simp-on-pe"></span><h1>3.5. Installing SIMP on Puppet Enterprise<a class="headerlink" href="#installing-simp-on-puppet-enterprise" title="Permalink to this headline">¶</a></h1>
<div class="contents local topic" id="contents">
<p class="topic-title first">Contents:</p>
<ul class="simple">
<li><a class="reference internal" href="#overview" id="id1">Overview</a></li>
<li><a class="reference internal" href="#system-requirements" id="id2">System Requirements</a><ul>
<li><a class="reference internal" href="#puppet-enterprise" id="id3">Puppet Enterprise</a></li>
<li><a class="reference internal" href="#enable-epel" id="id4">Enable EPEL</a></li>
<li><a class="reference internal" href="#install-the-simp-project-dependencies-repository" id="id5">Install The SIMP-project_dependencies Repository</a></li>
</ul>
</li>
<li><a class="reference internal" href="#disclaimer" id="id6">Disclaimer</a></li>
<li><a class="reference internal" href="#pre-install-tasks" id="id7">Pre-install tasks</a></li>
<li><a class="reference internal" href="#setting-up-your-control-repo" id="id8">Setting up your Control Repo</a></li>
<li><a class="reference internal" href="#configuring-hiera" id="id9">Configuring Hiera</a></li>
</ul>
</div>
<div class="section" id="overview">
<h2><a class="toc-backref" href="#id1">3.5.1. Overview</a><a class="headerlink" href="#overview" title="Permalink to this headline">¶</a></h2>
<p>As of 6.0, SIMP can now be installed on top of an existing
Puppet Enterprise installation. Once installed SIMP will
configure itself to add the necessary firewall rules, and service
level exclusions based only on changes made to the PE Console.</p>
<p>Installing SIMP on top of Puppet Enterprise is a multi-step process,
involving changes at the following places in your environment:</p>
<ul class="simple">
<li>control repo</li>
<li>global hiera</li>
<li>console classifier</li>
<li>Some manual shell commands on the Master of Masters (MoM).</li>
</ul>
<p>It is highly recommended to perform these steps in sequence to prevent
loss of connectivity.</p>
<p>At this time multiple compile masters and PE HA is not supported out
of the box in SIMP. We are currently working on a Technology Preview in
succeeding 6.x versions to support HA configurations out of the box. At this time HA support
requires manual configuration and only supports manual failover.</p>
</div>
<div class="section" id="system-requirements">
<h2><a class="toc-backref" href="#id2">3.5.2. System Requirements</a><a class="headerlink" href="#system-requirements" title="Permalink to this headline">¶</a></h2>
<div class="section" id="puppet-enterprise">
<h3><a class="toc-backref" href="#id3">3.5.2.1. Puppet Enterprise</a><a class="headerlink" href="#puppet-enterprise" title="Permalink to this headline">¶</a></h3>
<p>The following versions of Puppet Enterprise are currently supported:</p>
<table border="1" class="docutils">
<colgroup>
<col width="46%" />
<col width="54%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">PE Version</th>
<th class="head">SIMP Version</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>2016.4</td>
<td>6.0</td>
</tr>
<tr class="row-odd"><td>2016.5</td>
<td>6.0</td>
</tr>
<tr class="row-even"><td>2017.1</td>
<td>6.0</td>
</tr>
</tbody>
</table>
<p>If you are configuring a PE HA setup, it is strongly recommended to configure
the replica master before installing SIMP. The replica provision process makes
a lot of single time changes to the system to configure the replication, and
SIMP&#8217;s security restrictions may prevent it from working properly.</p>
</div>
<div class="section" id="enable-epel">
<h3><a class="toc-backref" href="#id4">3.5.2.2. Enable EPEL</a><a class="headerlink" href="#enable-epel" title="Permalink to this headline">¶</a></h3>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ sudo yum install epel-release -y
$ sudo yum install pygpgme yum-utils
</pre></div>
</div>
</div>
<div class="section" id="install-the-simp-project-dependencies-repository">
<h3><a class="toc-backref" href="#id5">3.5.2.3. Install The SIMP-project_dependencies Repository</a><a class="headerlink" href="#install-the-simp-project-dependencies-repository" title="Permalink to this headline">¶</a></h3>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The repository may contain items from external vendors, most notably Puppet,
Inc. and EPEL but may also contain non-SIMP project files that have been
compiled for distribution.</p>
</div>
<p>Add the following to <code class="docutils literal"><span class="pre">/etc/yum.repos.d/simp-project_dependencies.repo</span></code>,
replacing <code class="docutils literal"><span class="pre">6</span></code> with the appropriate version of SIMP. If the repo file
does not exist, create it. The repo file for <code class="docutils literal"><span class="pre">SIMP</span> <span class="pre">6.X</span></code> is shown below.</p>
<p>If you don&#8217;t know what versions map together, please see the
<a class="reference internal" href="../help/FAQ/SIMP_Version_Guide.html#faq-simp-version-guide"><span class="std std-ref">SIMP Version Guide</span></a>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The <strong>whitespace</strong> and <strong>alignment</strong> shown before the additional <code class="docutils literal"><span class="pre">gpgkey</span></code>
values <strong>must be preserved</strong></p>
</div>
<div class="highlight-bash"><div class="highlight"><pre><span></span><span class="o">[</span>simp-project_6_X_dependencies<span class="o">]</span>
<span class="nv">name</span><span class="o">=</span>simp-project_6_X_dependencies
<span class="nv">baseurl</span><span class="o">=</span>https://packagecloud.io/simp-project/6_X_Dependencies/el/<span class="nv">$releasever</span>/<span class="nv">$basearch</span>
<span class="nv">gpgcheck</span><span class="o">=</span><span class="m">1</span>
<span class="nv">enabled</span><span class="o">=</span><span class="m">1</span>
<span class="nv">gpgkey</span><span class="o">=</span>https://raw.githubusercontent.com/NationalSecurityAgency/SIMP/master/GPGKEYS/RPM-GPG-KEY-SIMP
       https://yum.puppetlabs.com/RPM-GPG-KEY-puppetlabs
       https://yum.puppetlabs.com/RPM-GPG-KEY-puppet
       https://apt.postgresql.org/pub/repos/yum/RPM-GPG-KEY-PGDG-94
       https://getfedora.org/static/352C64E5.txt
<span class="nv">sslverify</span><span class="o">=</span><span class="m">1</span>
<span class="nv">sslcacert</span><span class="o">=</span>/etc/pki/tls/certs/ca-bundle.crt
<span class="nv">metadata_expire</span><span class="o">=</span><span class="m">300</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="disclaimer">
<h2><a class="toc-backref" href="#id6">3.5.3. Disclaimer</a><a class="headerlink" href="#disclaimer" title="Permalink to this headline">¶</a></h2>
<p>SIMP will attempt to make minor compliance changes to Puppet
Enterprise on certain versions. However we have not made major changes
to bring it in-line with FIPS 140-2 to ensure that SIMP users who have
a valid support license do not invalidate their support by using SIMP.</p>
<p>XXX TODO Insert further information relevant to the disclaimer</p>
</div>
<div class="section" id="pre-install-tasks">
<h2><a class="toc-backref" href="#id7">3.5.4. Pre-install tasks</a><a class="headerlink" href="#pre-install-tasks" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="setting-up-your-control-repo">
<h2><a class="toc-backref" href="#id8">3.5.5. Setting up your Control Repo</a><a class="headerlink" href="#setting-up-your-control-repo" title="Permalink to this headline">¶</a></h2>
<p>SIMP uses a <a class="reference internal" href="../glossary.html#term-puppetfile"><span class="xref std std-term">Puppetfile</span></a> and distributes some of a <a class="reference internal" href="../glossary.html#term-control-repo"><span class="xref std std-term">Control Repo</span></a> in
the <code class="docutils literal"><span class="pre">simp-environment</span></code> package, or also in the <a href="#id10"><span class="problematic" id="id11">`simp-core`_</span></a> repository.:</p>
<p>On the filesystem of an installed SIMP system:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ tree -L <span class="m">1</span> /usr/share/simp/environments/simp/
/usr/share/simp/environments/simp/
├── environment.conf
├── hieradata
├── manifests
└── modules
</pre></div>
</div>
<p>Our git repo:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ tree -L <span class="m">1</span> src/assets/simp-environment/environments/simp
src/assets/simp-environment/environments/simp
├── environment.conf
├── hieradata/
└── manifests/
</pre></div>
</div>
<p>A Control Repo contains the modules, hieradata, and roles/profiles required for
an infrastructure, and keeping it all in a git repo creates a workflow for
updating and developing on your Puppet infrastructure.</p>
<p>The modules are defined in a <a class="reference internal" href="../glossary.html#term-puppetfile"><span class="xref std std-term">Puppetfile</span></a>, which SIMP uses as a development
tool. We keep an up-to-date Puppetfile in the core of our repo, which you can
download using this snippet:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ curl -o Puppetfile https://raw.githubusercontent.com/simp/simp-core/6.0.0-0/Puppetfile.stable
</pre></div>
</div>
<p>The example Puppetfile is labeled <em>stable</em>, meaning that the versions of the
modules it contains are the ones contained in the last SIMP release. You can go
to any previous release and download a Puppetfile with references to older
modules from the git history of the <code class="docutils literal"><span class="pre">simp-core</span></code> repo.</p>
<p>Our Puppetfile pulls down every dependency SIMP needs, which is currently
contains more than just modules. Open up the <code class="docutils literal"><span class="pre">Puppetfile</span></code> that was just
downloaded and remove the lines from <code class="docutils literal"><span class="pre">moduledir</span> <span class="pre">'src'</span></code> to
<code class="docutils literal"><span class="pre">moduledir</span> <span class="pre">'src/puppet/modules'</span></code>. That should just leave the Puppet modules.</p>
<p>Change into the directory you&#8217;re using from above and run <code class="docutils literal"><span class="pre">git</span> <span class="pre">init</span></code> to create
a control repo. Puppet, Inc has some great <a href="#id12"><span class="problematic" id="id13">`documentation of a control repo online`_</span></a>.</p>
</div>
<div class="section" id="configuring-hiera">
<h2><a class="toc-backref" href="#id9">3.5.6. Configuring Hiera</a><a class="headerlink" href="#configuring-hiera" title="Permalink to this headline">¶</a></h2>
<p>In order to configure a working SIMP environment under Puppet Enterprise,
you will need to add some variables to Hiera in your &#8216;common.yaml&#8217;</p>
<div class="code bash highlight-default"><div class="highlight"><pre><span></span><span class="n">simp_options</span><span class="p">::</span><span class="n">server_distribution</span><span class="p">:</span> <span class="s1">&#39;PE&#39;</span>
</pre></div>
</div>
<p>XXX TODO Node Classification recommendations</p>
</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="Building_A_SIMP_ISO.html" class="btn btn-neutral float-right" title="3.6. Building a SIMP ISO" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="Installing_SIMP_using_r10k.html" class="btn btn-neutral" title="3.4. Installing SIMP using r10k or Code Manager" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, THE SIMP TEAM.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'4.2.X',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>