

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>4.5.1. Classification and Data &mdash; SIMP 5.2.1-0 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  

  
    <link rel="stylesheet" href="https://media.readthedocs.org/css/sphinx_rtd_theme.css" type="text/css" />
  
    <link rel="stylesheet" href="https://media.readthedocs.org/css/readthedocs-doc-embed.css" type="text/css" />
  
    <link rel="stylesheet" href="../../_static/css_overrides.css" type="text/css" />
  

  
    <link rel="top" title="SIMP 5.2.1-0 documentation" href="../../index.html"/>
        <link rel="up" title="4.5. SIMP Administration" href="../SIMP_Administration.html"/>
        <link rel="next" title="4.5.2. Integrating Applications" href="Integrating_Applications.html"/>
        <link rel="prev" title="4.5. SIMP Administration" href="../SIMP_Administration.html"/> 

  
  <script src="../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-nav-search">
        

        
          <a href="../../index.html">
        

        
          
          <img src="../../_static/SIMP_Logo.png" class="logo" />
        
        </a>

        
          
          
            <div class="version">
              5.2.1
            </div>
          
        

        
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

        
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        
          
          
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../index.html">Welcome to the SIMP documentation!</a></li>
</ul>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../getting_started_guide/Just_Install.html">1. For the Impatient</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../dynamic/Changelog.html">2. Changelog</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../getting_started_guide/index.html">3. Getting Started</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">4. User Guide</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../Introduction.html">4.1. Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Client_Management.html">4.2. Client Management</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Client_Management.html#configure-pxe-boot">4.3. Configure PXE Boot</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Client_Management.html#apply-certificates">4.4. Apply Certificates</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../SIMP_Administration.html">4.5. SIMP Administration</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">4.5.1. Classification and Data</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#node-classification-in-simp">4.5.1.1. Node Classification in SIMP</a></li>
<li class="toctree-l4"><a class="reference internal" href="#hiera-in-simp">4.5.1.2. Hiera in SIMP</a></li>
<li class="toctree-l4"><a class="reference internal" href="#assigning-classes-to-nodes">4.5.1.3. Assigning Classes to Nodes</a></li>
<li class="toctree-l4"><a class="reference internal" href="#assigning-defined-types-to-nodes">4.5.1.4. Assigning Defined Types to Nodes</a></li>
<li class="toctree-l4"><a class="reference internal" href="#simp-file-structure">4.5.1.5. SIMP File Structure</a></li>
<li class="toctree-l4"><a class="reference internal" href="#second-modulepath">4.5.1.6. Second Modulepath</a></li>
<li class="toctree-l4"><a class="reference internal" href="#hiera">4.5.1.7. Hiera</a></li>
<li class="toctree-l4"><a class="reference internal" href="#simp-scenarios">4.5.1.8. SIMP Scenarios</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="Integrating_Applications.html">4.5.2. Integrating Applications</a></li>
<li class="toctree-l3"><a class="reference internal" href="General_Administration.html">4.5.3. General Administration</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../User_Management.html">4.6. User Management</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Troubleshooting.html">4.7. Troubleshooting Common Issues</a></li>
<li class="toctree-l2"><a class="reference internal" href="../HOWTO.html">4.8. SIMP HOWTO Guides</a></li>
<li class="toctree-l2"><a class="reference internal" href="../SIMP_Package_Data.html">4.9. Package Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#indices-and-tables">4.10. Indices and tables</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../contributors_guide/index.html">5. Contributing to SIMP</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../security_conop/index.html">6. Security Concept of Operations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../security_mapping/index.html">7. Security Control Mapping</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../help/index.html">8. Help</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../license.html">9. License</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../license.html#contact">10. Contact</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../glossary.html">11. Glossary of Terms</a></li>
</ul>

          
        
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../../index.html">SIMP</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../index.html">Docs</a> &raquo;</li>
      
          <li><a href="../index.html">4. SIMP User Guide</a> &raquo;</li>
      
          <li><a href="../SIMP_Administration.html">4.5. SIMP Administration</a> &raquo;</li>
      
    <li>4.5.1. Classification and Data</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../../_sources/user_guide/SIMP_Administration/Classification_and_Data.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="classification-and-data">
<span id="id1"></span><h1>4.5.1. Classification and Data<a class="headerlink" href="#classification-and-data" title="Permalink to this headline">¶</a></h1>
<div class="section" id="node-classification-in-simp">
<h2>4.5.1.1. Node Classification in SIMP<a class="headerlink" href="#node-classification-in-simp" title="Permalink to this headline">¶</a></h2>
<p>From the Puppet, Inc website:</p>
<blockquote>
<div>Hiera is a key/value lookup tool for configuration data, built to set
node-specific data without repeating yourself.</div></blockquote>
<p>SIMP uses <a class="reference internal" href="../../glossary.html#term-hiera"><span class="xref std std-term">Hiera</span></a> to attempt to make configuration of the overall system easier
for our end users by providing a simple, centralized, method for setting class
parameters using <a class="reference external" href="https://docs.puppet.com/hiera/3.3/puppet.html#automatic-parameter-lookup">automatic parameter lookup</a> and as a method for
<a class="reference external" href="https://docs.puppet.com/hiera/3.3/puppet.html#assigning-classes-to-nodes-with-hiera-hierainclude">basic node classification</a>.</p>
<p>It is <strong>highly recommended</strong> that you read the <a class="reference external" href="https://docs.puppet.com/hiera/3.3/complete_example.html">Hiera Documentation</a> prior to
jumping into using a SIMP system.</p>
</div>
<div class="section" id="hiera-in-simp">
<h2>4.5.1.2. Hiera in SIMP<a class="headerlink" href="#hiera-in-simp" title="Permalink to this headline">¶</a></h2>
<p>As mentioned, SIMP users are expected to make extensive use of Hiera to set
parameters, particularly those that are deep within the code.</p>
<p>The default Hiera hierarchy used by SIMP looks like the following:</p>
<div class="code yaml highlight-default"><div class="highlight"><pre><span></span><span class="o">---</span>
<span class="p">:</span><span class="n">backends</span><span class="p">:</span>
  <span class="o">-</span> <span class="s1">&#39;yaml&#39;</span>
<span class="p">:</span><span class="n">hierarchy</span><span class="p">:</span>
  <span class="c1"># Most specific</span>
  <span class="o">-</span> <span class="s1">&#39;hosts/%</span><span class="si">{trusted.certname}</span><span class="s1">&#39;</span>
  <span class="o">-</span> <span class="s1">&#39;hosts/%</span><span class="si">{facts.fqdn}</span><span class="s1">&#39;</span>
  <span class="o">-</span> <span class="s1">&#39;hosts/%</span><span class="si">{facts.hostname}</span><span class="s1">&#39;</span>
  <span class="o">-</span> <span class="s1">&#39;domains/%</span><span class="si">{facts.domain}</span><span class="s1">&#39;</span>
  <span class="o">-</span> <span class="s1">&#39;%</span><span class="si">{facts.os.family}</span><span class="s1">&#39;</span>
  <span class="o">-</span> <span class="s1">&#39;%</span><span class="si">{facts.os.name}</span><span class="s1">/%</span><span class="si">{facts.os.release.full}</span><span class="s1">&#39;</span>
  <span class="o">-</span> <span class="s1">&#39;%</span><span class="si">{facts.os.name}</span><span class="s1">/%</span><span class="si">{facts.os.release.major}</span><span class="s1">&#39;</span>
  <span class="o">-</span> <span class="s1">&#39;%</span><span class="si">{facts.os.name}</span><span class="s1">&#39;</span>
  <span class="o">-</span> <span class="s1">&#39;hostgroups/%{::hostgroup}&#39;</span>
  <span class="o">-</span> <span class="s1">&#39;default&#39;</span>
  <span class="o">-</span> <span class="s1">&#39;compliance_profiles/%{::compliance_profile}&#39;</span>
  <span class="o">-</span> <span class="s1">&#39;simp_config_settings&#39;</span>
  <span class="o">-</span> <span class="s1">&#39;scenarios/%{::simp_scenario}&#39;</span>
  <span class="c1"># Least specific</span>
<span class="p">:</span><span class="n">logger</span><span class="p">:</span> <span class="s1">&#39;puppet&#39;</span>
<span class="p">:</span><span class="n">yaml</span><span class="p">:</span>
  <span class="p">:</span><span class="n">datadir</span><span class="p">:</span> <span class="s1">&#39;/etc/puppetlabs/code/environments/%{::environment}/hieradata&#39;</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">This may not be accurate for your version of SIMP, please check your local
Hiera settings!</p>
</div>
<p>The rest of this document will use this hierarchy as a reference.</p>
</div>
<div class="section" id="assigning-classes-to-nodes">
<h2>4.5.1.3. Assigning Classes to Nodes<a class="headerlink" href="#assigning-classes-to-nodes" title="Permalink to this headline">¶</a></h2>
<p>Assigning classes to nodes can be done in a few ways in SIMP. First, there is a
a <code class="docutils literal"><span class="pre">lookup</span></code> function in <code class="docutils literal"><span class="pre">/etc/puppetlabs/code/environments/simp/manifests/site.pp</span></code>
that looks for an array called <code class="docutils literal"><span class="pre">classes</span></code> in your hierarchy. It also looks for
an array called <code class="docutils literal"><span class="pre">class_exclusions</span></code>, which can be used to remove classes from
the classes array. The classes that are included are the result of
<code class="docutils literal"><span class="pre">$classes</span> <span class="pre">-</span> <span class="pre">$class_exclusions</span></code>. If classes need to be added to all nodes, a
<code class="docutils literal"><span class="pre">classes</span></code> array could be added to the <code class="docutils literal"><span class="pre">default.yaml</span></code> in your hieradata,
like this:</p>
<div class="highlight-yaml"><div class="highlight"><pre><span></span><span class="nn">---</span>
  <span class="l l-Scalar l-Scalar-Plain">classes</span><span class="p p-Indicator">:</span>
    <span class="p p-Indicator">-</span> <span class="s">&#39;site::example_class&#39;</span>
<span class="nn">---</span>
</pre></div>
</div>
<p>A similar array could be created in any other layer in the hierarchy, and it
will be merged with the &#8216;unique&#8217; strategy by the <code class="docutils literal"><span class="pre">lookup</span></code> function noted
above.</p>
<p>The SIMP profile module also includes other classes needed for a secure
baseline, which are discused below in the <a class="reference internal" href="#simp-scenarios">simp scenarios</a> section.</p>
</div>
<div class="section" id="assigning-defined-types-to-nodes">
<h2>4.5.1.4. Assigning Defined Types to Nodes<a class="headerlink" href="#assigning-defined-types-to-nodes" title="Permalink to this headline">¶</a></h2>
<p>Defined types do not have the ability to receive parameters via Hiera in the
traditional sense. To include a defined type on a node, one could use
<code class="docutils literal"><span class="pre">create_resources</span></code>, but this is messy and discouraged. Instead, create your
own profile or add a class to the SIMP <code class="docutils literal"><span class="pre">site</span></code> module such as:
<code class="docutils literal"><span class="pre">/etc/puppetlabs/code/environments/simp/modules/site/manifests/my_site.pp</span></code>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">You can find a working example of this in the <a class="reference internal" href="../Client_Management.html#pxe-boot"><span class="std std-ref">Configure PXE Boot</span></a> section
of the documentation</p>
</div>
</div>
<div class="section" id="simp-file-structure">
<h2>4.5.1.5. SIMP File Structure<a class="headerlink" href="#simp-file-structure" title="Permalink to this headline">¶</a></h2>
<p>The default puppet environment in SIMP, located at
<code class="docutils literal"><span class="pre">/etc/puppetlabs/code/environments/simp</span></code>, contains almost
all necessary files for a Puppet infrastructure. It will look like this on a
fresh SIMP system:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>/etc/puppetlabs/code/environments/simp/
├── environment.conf
├── hieradata/
├── manifests/
└── modules/
</pre></div>
</div>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">environment.conf</span></code> - Sets the environment to include the second SIMP modulepath.</li>
<li><code class="docutils literal"><span class="pre">manifests/</span></code> - Contains site.pp and all other node manifests.</li>
<li><code class="docutils literal"><span class="pre">hieradata/</span></code> - Default location of the yaml files which contain your node data</li>
<li><code class="docutils literal"><span class="pre">modules/</span></code> - Default install location of Puppet modules. Each module RPM copies files here during installation from <code class="docutils literal"><span class="pre">/usr/share/simp/modules</span></code>.</li>
</ul>
</div>
<div class="section" id="second-modulepath">
<h2>4.5.1.6. Second Modulepath<a class="headerlink" href="#second-modulepath" title="Permalink to this headline">¶</a></h2>
<p>SIMP utilizes a second modulepath to ensure that deployment tools like r10k
don&#8217;t squash keydist and some krb5 files. The path is
<code class="docutils literal"><span class="pre">/var/simp/environments/simp/site_files/</span></code>. <a class="reference internal" href="../Client_Management.html#certificates"><span class="std std-ref">Apply Certificates</span></a> are stored there.</p>
</div>
<div class="section" id="hiera">
<h2>4.5.1.7. Hiera<a class="headerlink" href="#hiera" title="Permalink to this headline">¶</a></h2>
<div class="highlight-bash"><div class="highlight"><pre><span></span>/etc/puppetlabs/code/environments/simp/hieradata/
├── CentOS -&gt; RedHat/
├── compliance_profiles/
├── default.yaml
├── hostgroups/
├── hosts/
├── RedHat/
├── scenarios/
└── simp_config_settings.yaml
</pre></div>
</div>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">hieradata/hosts/</span></code> - By populating this directory with some.host.name.yaml file, you can assign parameters to host some.host.name</li>
<li><code class="docutils literal"><span class="pre">hieradata/domains/</span></code> - Same principal as hosts, but domain names.</li>
<li><code class="docutils literal"><span class="pre">hieradata/Redhat/</span></code> - RedHat-specific hiera settings.</li>
<li><code class="docutils literal"><span class="pre">hieradata/CentOS/</span></code> - CentOS-specific hiera settings, symlinked to <code class="docutils literal"><span class="pre">hieradata/Redhat/</span></code>.</li>
<li><code class="docutils literal"><span class="pre">hieradata/hostgroups/</span></code> - The hostgroup of a node can be computed in <cite>site.pp</cite>. Nodes assigned to hostgroup <cite>$hostgroup</cite> will read hiera from a file named <cite>&lt;hostgroup&gt;.yaml</cite> in this directory.</li>
<li><code class="docutils literal"><span class="pre">hieradata/default.yaml</span></code> - Settings that should be applied to the entire infrastructure.</li>
<li><code class="docutils literal"><span class="pre">hieradata/simp_config_settings.yaml</span></code> - Contains the variables needed to configure SIMP. Added by <code class="docutils literal"><span class="pre">simp</span> <span class="pre">config</span></code>.</li>
<li><code class="docutils literal"><span class="pre">hieradata/scenarios/</span></code> - Directory containing SIMP Scenarios, set in <code class="docutils literal"><span class="pre">manifests/site.pp</span></code>.</li>
</ul>
<p><code class="docutils literal"><span class="pre">/etc/puppetlabs/puppet/hiera.yaml</span></code> - Hiera&#8217;s config file, used to control the
hierarchy of your backends. The order of the files above mirrors that order in
the distributed hiera.yaml.</p>
</div>
<div class="section" id="simp-scenarios">
<span id="id2"></span><h2>4.5.1.8. SIMP Scenarios<a class="headerlink" href="#simp-scenarios" title="Permalink to this headline">¶</a></h2>
<p>SIMP scenarios are groups of classes, settings, and simp_options that ensure the
system is compliant and secure.</p>
<p>There are currently three SIMP scenarios:
- <em>simp</em>
- <em>simp_lite</em>
- <em>poss</em></p>
<p>The <em>simp</em> scenario includes all security features enabled by default, including
iptables and svckill. This scenario is what stock SIMP used to look like in
previous releases.</p>
<p>The <em>simp_lite</em> scenario offers many security features, with a few explicity
turned off. This scenario was designed to make it easier to implement SIMP in an
existing environment, because it might not be trivial to flip SELinux to
Enforcing on all nodes.</p>
<p>The <em>poss</em> option is the barebones option. It only includes the <code class="docutils literal"><span class="pre">pupmod</span></code>
class, to configure Puppet agent on clients. All of the simp_options default to
false, so SIMP will not do a lot of modification to clients through Puppet when
using this scenario.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The SIMP or Puppet server is exempt from most of these settings, and will be
using most features from the <em>simp</em> scenario by default. The SIMP server
should only have services on it related to Puppet and systems management, and
SIMP modules all work with all security features enabled. See the
<code class="docutils literal"><span class="pre">puppet.your.domain.yaml</span></code> in the <code class="docutils literal"><span class="pre">hieradata/hosts</span></code> directory for details.</p>
</div>
</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="Integrating_Applications.html" class="btn btn-neutral float-right" title="4.5.2. Integrating Applications" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../SIMP_Administration.html" class="btn btn-neutral" title="4.5. SIMP Administration" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, THE SIMP TEAM.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../',
            VERSION:'4.2.X',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>